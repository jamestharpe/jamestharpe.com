{"expireTime":9007200860997566000,"key":"transformer-remark-markdown-ast-fa8c558540756b51f08e0fe94cab4869-gatsby-remark-graphgatsby-remark-prismjsgatsby-remark-katex-","val":{"type":"root","children":[{"type":"heading","depth":1,"children":[{"type":"text","value":"\"Forbidden path outside the build context\"","position":{"start":{"line":2,"column":3,"offset":4},"end":{"line":2,"column":45,"offset":46},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":2,"column":45,"offset":46},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"I was recently attempting to Dockerize a Node project, so I added a ","position":{"start":{"line":4,"column":1,"offset":50},"end":{"line":4,"column":69,"offset":118},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">docker</code>","position":{"start":{"line":4,"column":69,"offset":118},"end":{"line":4,"column":77,"offset":126},"indent":[]}},{"type":"text","value":" folder to the project and created a simple ","position":{"start":{"line":4,"column":77,"offset":126},"end":{"line":4,"column":121,"offset":170},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">Dockerfile</code>","position":{"start":{"line":4,"column":121,"offset":170},"end":{"line":4,"column":133,"offset":182},"indent":[]}},{"type":"text","value":" to get started:","position":{"start":{"line":4,"column":133,"offset":182},"end":{"line":4,"column":149,"offset":198},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":50},"end":{"line":4,"column":149,"offset":198},"indent":[]}},{"type":"html","lang":"dockerfile","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span>  node<span class=\"token punctuation\">:</span>alpine\n<span class=\"token keyword\">WORKDIR</span> /app\n<span class=\"token keyword\">COPY</span> ../ ./\n<span class=\"token keyword\">RUN</span> npm install\n<span class=\"token keyword\">EXPOSE</span> 80\n<span class=\"token keyword\">ENTRYPOINT</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"npm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span> <span class=\"token punctuation\">]</span></code></pre></div>","position":{"start":{"line":6,"column":1,"offset":202},"end":{"line":13,"column":4,"offset":325},"indent":[1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"However, when I tried to build the image, I got the following output:","position":{"start":{"line":15,"column":1,"offset":329},"end":{"line":15,"column":70,"offset":398},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":329},"end":{"line":15,"column":70,"offset":398},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ docker build -t node-app <span class=\"token builtin class-name\">.</span>\nSending build context to Docker daemon  <span class=\"token number\">53</span>.76kB\nStep <span class=\"token number\">1</span>/6 <span class=\"token builtin class-name\">:</span> FROM node:alpine\n ---<span class=\"token operator\">></span> 04a3ba95f191\nStep <span class=\"token number\">2</span>/6 <span class=\"token builtin class-name\">:</span> WORKDIR /app\n ---<span class=\"token operator\">></span> 85fff9a66b84\nRemoving intermediate container e2c838595c90\nStep <span class=\"token number\">3</span>/6 <span class=\"token builtin class-name\">:</span> COPY <span class=\"token punctuation\">..</span>/ ./\nCOPY failed: Forbidden path outside the build context: <span class=\"token punctuation\">..</span>/ <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>","position":{"start":{"line":17,"column":1,"offset":402},"end":{"line":27,"column":4,"offset":720},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Note the error: ","position":{"start":{"line":29,"column":1,"offset":724},"end":{"line":29,"column":17,"offset":740},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"COPY failed: Forbidden path outside the build context: ../ ()","position":{"start":{"line":29,"column":19,"offset":742},"end":{"line":29,"column":80,"offset":803},"indent":[]}}],"position":{"start":{"line":29,"column":17,"offset":740},"end":{"line":29,"column":82,"offset":805},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":724},"end":{"line":29,"column":82,"offset":805},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"According to Docker's ","position":{"start":{"line":31,"column":1,"offset":809},"end":{"line":31,"column":23,"offset":831},"indent":[]}},{"type":"link","title":null,"url":"https://docs.docker.com/engine/reference/builder/#copy","children":[{"type":"html","value":"<code class=\"language-text\">COPY</code>","position":{"start":{"line":31,"column":24,"offset":832},"end":{"line":31,"column":30,"offset":838},"indent":[]}},{"type":"text","value":" documentation","position":{"start":{"line":31,"column":30,"offset":838},"end":{"line":31,"column":44,"offset":852},"indent":[]}}],"position":{"start":{"line":31,"column":23,"offset":831},"end":{"line":31,"column":101,"offset":909},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":31,"column":101,"offset":909},"end":{"line":31,"column":102,"offset":910},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":809},"end":{"line":31,"column":102,"offset":910},"indent":[]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"html","value":"<code class=\"language-text\">COPY</code>","position":{"start":{"line":33,"column":3,"offset":916},"end":{"line":33,"column":9,"offset":922},"indent":[]}},{"type":"text","value":" obeys the following rules:","position":{"start":{"line":33,"column":9,"offset":922},"end":{"line":33,"column":36,"offset":949},"indent":[]}}],"position":{"start":{"line":33,"column":3,"offset":916},"end":{"line":33,"column":36,"offset":949},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":35,"column":5,"offset":958},"end":{"line":35,"column":9,"offset":962},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">&lt;src&gt;</code>","position":{"start":{"line":35,"column":9,"offset":962},"end":{"line":35,"column":16,"offset":969},"indent":[]}},{"type":"text","value":" path must be inside the context of the build; you cannot ","position":{"start":{"line":35,"column":16,"offset":969},"end":{"line":35,"column":74,"offset":1027},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">COPY ../something /something</code>","position":{"start":{"line":35,"column":74,"offset":1027},"end":{"line":35,"column":104,"offset":1057},"indent":[]}},{"type":"text","value":", because the first step of a ","position":{"start":{"line":35,"column":104,"offset":1057},"end":{"line":35,"column":134,"offset":1087},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">docker build</code>","position":{"start":{"line":35,"column":134,"offset":1087},"end":{"line":35,"column":148,"offset":1101},"indent":[]}},{"type":"text","value":" is to send the context directory (and subdirectories) to the docker daemon.","position":{"start":{"line":35,"column":148,"offset":1101},"end":{"line":35,"column":224,"offset":1177},"indent":[]}}],"position":{"start":{"line":35,"column":5,"offset":958},"end":{"line":35,"column":224,"offset":1177},"indent":[]}}],"position":{"start":{"line":35,"column":3,"offset":956},"end":{"line":35,"column":224,"offset":1177},"indent":[]}}],"position":{"start":{"line":35,"column":3,"offset":956},"end":{"line":35,"column":224,"offset":1177},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":914},"end":{"line":35,"column":224,"offset":1177},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"It turns out that ","position":{"start":{"line":37,"column":1,"offset":1181},"end":{"line":37,"column":19,"offset":1199},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"you cannot include files outside Docker's build context","position":{"start":{"line":37,"column":21,"offset":1201},"end":{"line":37,"column":76,"offset":1256},"indent":[]}}],"position":{"start":{"line":37,"column":19,"offset":1199},"end":{"line":37,"column":78,"offset":1258},"indent":[]}},{"type":"text","value":". However, you ","position":{"start":{"line":37,"column":78,"offset":1258},"end":{"line":37,"column":93,"offset":1273},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"can","position":{"start":{"line":37,"column":94,"offset":1274},"end":{"line":37,"column":97,"offset":1277},"indent":[]}}],"position":{"start":{"line":37,"column":93,"offset":1273},"end":{"line":37,"column":98,"offset":1278},"indent":[]}},{"type":"text","value":" copy files from the Dockerfile's parent directory.","position":{"start":{"line":37,"column":98,"offset":1278},"end":{"line":37,"column":149,"offset":1329},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1181},"end":{"line":37,"column":149,"offset":1329},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"How to ","position":{"start":{"line":39,"column":4,"offset":1336},"end":{"line":39,"column":11,"offset":1343},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">COPY</code>","position":{"start":{"line":39,"column":11,"offset":1343},"end":{"line":39,"column":17,"offset":1349},"indent":[]}},{"type":"text","value":" Files from the Dockerfile Parent Directory","position":{"start":{"line":39,"column":17,"offset":1349},"end":{"line":39,"column":60,"offset":1392},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":1333},"end":{"line":39,"column":60,"offset":1392},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"I tried several combinations of command line arguments to include the parent directory in the context, and finally landed on the solution: start from the parent directory, and pass the Dockerfile as an argument.","position":{"start":{"line":41,"column":1,"offset":1396},"end":{"line":41,"column":212,"offset":1607},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":1396},"end":{"line":41,"column":212,"offset":1607},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To do this, first update the ","position":{"start":{"line":43,"column":1,"offset":1611},"end":{"line":43,"column":30,"offset":1640},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">COPY</code>","position":{"start":{"line":43,"column":30,"offset":1640},"end":{"line":43,"column":36,"offset":1646},"indent":[]}},{"type":"text","value":" command to use the current (","position":{"start":{"line":43,"column":36,"offset":1646},"end":{"line":43,"column":65,"offset":1675},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">./</code>","position":{"start":{"line":43,"column":65,"offset":1675},"end":{"line":43,"column":69,"offset":1679},"indent":[]}},{"type":"text","value":") directory:","position":{"start":{"line":43,"column":69,"offset":1679},"end":{"line":43,"column":81,"offset":1691},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":1611},"end":{"line":43,"column":81,"offset":1691},"indent":[]}},{"type":"html","lang":"dockerfile","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span>  node<span class=\"token punctuation\">:</span>alpine\n<span class=\"token keyword\">WORKDIR</span> /app\n<span class=\"token keyword\">COPY</span> ./ ./\n<span class=\"token keyword\">RUN</span> npm install\n<span class=\"token keyword\">EXPOSE</span> 80\n<span class=\"token keyword\">ENTRYPOINT</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"npm\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"start\"</span> <span class=\"token punctuation\">]</span></code></pre></div>","position":{"start":{"line":45,"column":1,"offset":1695},"end":{"line":52,"column":4,"offset":1817},"indent":[1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Next, ","position":{"start":{"line":54,"column":1,"offset":1821},"end":{"line":54,"column":7,"offset":1827},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">cd ..</code>","position":{"start":{"line":54,"column":7,"offset":1827},"end":{"line":54,"column":14,"offset":1834},"indent":[]}},{"type":"text","value":" into the parent directory and run ","position":{"start":{"line":54,"column":14,"offset":1834},"end":{"line":54,"column":49,"offset":1869},"indent":[]}},{"type":"html","value":"<code class=\"language-text\">docker build</code>","position":{"start":{"line":54,"column":49,"offset":1869},"end":{"line":54,"column":63,"offset":1883},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":54,"column":63,"offset":1883},"end":{"line":54,"column":64,"offset":1884},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":1821},"end":{"line":54,"column":64,"offset":1884},"indent":[]}},{"type":"html","lang":"bash","meta":null,"value":"<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">~/Code/node-app/docker\n$ <span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span>\n\n~/Code/node-app\n$ docker build -t node-app -f docker/Dockerfile <span class=\"token builtin class-name\">.</span>\nSending build context to Docker daemon  <span class=\"token number\">263</span>.7MB\n<span class=\"token punctuation\">..</span>.\nSuccessfully built d296bf765369\nSuccessfully tagged node-app:latest</code></pre></div>","position":{"start":{"line":56,"column":1,"offset":1888},"end":{"line":66,"column":4,"offset":2127},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Success!","position":{"start":{"line":68,"column":1,"offset":2131},"end":{"line":68,"column":9,"offset":2139},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":2131},"end":{"line":68,"column":9,"offset":2139},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":69,"column":1,"offset":2141}}}}