{"expireTime":9007200860997566000,"key":"transformer-remark-markdown-html-047d0996228044cb6f66df941e2f0b13-gatsby-remark-graphgatsby-remark-prismjsgatsby-remark-katex-","val":"<h1>Automate Your Development Environment Setup</h1>\n<p>Starting from a fresh OS installation, manually installing and configuring a full development environment can take several days. Even then, it's easy to forget some bit of configuration or forget to install some critical software. Automation makes it easy to save a ton of time and minimize disruption.</p>\n<p>Most of the software I write is developed on Windows, so I decided to write the script using PowerShell and <a href=\"https://chocolatey.org/\">Chocolatey</a>. MacOS users can follow a similar pattern using <a href=\"https://brew.sh/\">Homebrew</a>.</p>\n<h2>Overview of the Automation Process</h2>\n<p>The goal of the script is to start from a base OS installation and finish with a complete development environment. To write the script, it's easiest to use a write-test-tweak approach:</p>\n<ol>\n<li>Write a command in the PowerShell ISE (running elevated)</li>\n<li>Copy-paste the command from the script into the shell panel and execute it</li>\n<li>Tweak the command if needed</li>\n</ol>\n<p>Once your script is completed, you can easily maintain it by following the same process every time you install a new tool or adjust a setting. I prefer to store my script in OneDrive for easy access from a base Windows installation (which includes OneDrive), but I also check it in to GitHub to share with the world.</p>\n<blockquote>\n<p><strong>Warning</strong>: If you're development environment is already setup manually, installing software via Chocolatey can sometimes cause conflicts. It's best to uninstall any applications you'll be managing with Chocolatey, then reinstall with Chocolatey (or just start from scratch).</p>\n</blockquote>\n<h2>Basic Script Structure</h2>\n<p>I've broken <a href=\"https://github.com/jamestharpe/windows-development-environment/blob/master/env-windows.ps1\">my script</a> into four sections:</p>\n<ol>\n<li>Utility methods</li>\n<li>Chocolatey install</li>\n<li>Configure Windows settings</li>\n<li>Install and configure tools</li>\n</ol>\n<h2>Utility Method: Refresh the PATH environment variable in PowerShell</h2>\n<p>Many of the tools you'll instal will have dependencies, which need to be available via the Windows PATH environment variable for the script to succeed. PowerShell does not automatically pick up changes to the PATH. To do that, this simple utility function will help:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token keyword\">function</span> RefreshEnvPath\n<span class=\"token punctuation\">{</span>\n    <span class=\"token variable\">$env</span>:Path = <span class=\"token namespace\">[System.Environment]</span>::GetEnvironmentVariable<span class=\"token punctuation\">(</span><span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"Machine\"</span><span class=\"token punctuation\">)</span> `\n        <span class=\"token operator\">+</span> <span class=\"token string\">\";\"</span> <span class=\"token operator\">+</span> <span class=\"token namespace\">[System.Environment]</span>::GetEnvironmentVariable<span class=\"token punctuation\">(</span><span class=\"token string\">\"Path\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"User\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>This method simply re-reads the Machine and User <code class=\"language-text\">Path</code> environment variables, concatenates them, and stores them in the variable PowerShell uses to read the PATH.</p>\n<h2>Script to Install Chocolatey</h2>\n<p>The next addition to the script is to install Chocolatey (choco, for short):</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token function\">iex</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token function\">New-Object</span> System<span class=\"token punctuation\">.</span>Net<span class=\"token punctuation\">.</span>WebClient<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>DownloadString<span class=\"token punctuation\">(</span><span class=\"token string\">'https://chocolatey.org/install.ps1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nRefreshEnvPath</code></pre></div>\n<p>Note the call to <code class=\"language-text\">RefreshEnvPath</code>: That ensures the <code class=\"language-text\">choco</code> command will run without having to start a new PowerShell window.</p>\n<h2>Script to Configure Windows Settings</h2>\n<p>The Windows Explorer default settings don't work well for most developers. The following script will show file extensions and hidden files:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token comment\"># Navigate registry</span>\n<span class=\"token function\">Push-Location</span>\n<span class=\"token function\">Set-Location</span> HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\n\n<span class=\"token comment\"># Show file extensions</span>\n<span class=\"token function\">Set-ItemProperty</span> <span class=\"token punctuation\">.</span> HideFileExt <span class=\"token string\">\"0\"</span>\n<span class=\"token comment\"># Show hidden files</span>\n<span class=\"token function\">Set-ItemProperty</span> <span class=\"token punctuation\">.</span> Hidden <span class=\"token string\">\"1\"</span>\n\n<span class=\"token function\">Pop-Location</span>\n\n<span class=\"token comment\"># Force Windows Explorer restart so settings take effect</span>\n<span class=\"token function\">Stop-Process</span> <span class=\"token operator\">-</span>processName: Explorer <span class=\"token operator\">-</span>force</code></pre></div>\n<h2>Script to Install Developer Tools</h2>\n<p>With Chocolaty installed, to install development tools requires a simple call to <code class=\"language-text\">choco install [tool name] --yes</code>. The <code class=\"language-text\">--yes</code> flag is required so that the script doesn't prompt you to approve each installation before proceeding. For example, to install Visual Studio Code, simply run:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">choco install vscode <span class=\"token operator\">--</span>yes</code></pre></div>\n<p>When installing a tool that needs to be configured or is a prerequisite of another tool, remember to call <code class=\"language-text\">RefreshEnvPath</code> before proceeding, or your script will error out.</p>\n<h3>Script to Customize VS Code</h3>\n<p>Vanilla Visual Studio Code isn't very interesting, so let's customize it by installing some common plug-ins. Here's what I install by default:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">RefreshEnvPath\n\n<span class=\"token comment\"># Pretty icons</span>\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> robertohuertasm<span class=\"token punctuation\">.</span>vscode<span class=\"token operator\">-</span>icons\n\n<span class=\"token comment\"># PowerShell</span>\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> ms<span class=\"token operator\">-</span>vscode<span class=\"token punctuation\">.</span>PowerShell\n\n<span class=\"token comment\"># HTML, CSS, JS</span>\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> Zignd<span class=\"token punctuation\">.</span>html<span class=\"token operator\">-</span>css<span class=\"token operator\">-</span><span class=\"token keyword\">class</span><span class=\"token operator\">-</span>completion\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> lonefy<span class=\"token punctuation\">.</span>vscode<span class=\"token operator\">-</span>JS<span class=\"token operator\">-</span>CSS<span class=\"token operator\">-</span>HTML<span class=\"token operator\">-</span>formatter\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> robinbentley<span class=\"token punctuation\">.</span>sass<span class=\"token operator\">-</span>indented\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> dbaeumer<span class=\"token punctuation\">.</span>vscode<span class=\"token operator\">-</span>eslint\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> steoates<span class=\"token punctuation\">.</span>autoimport\n\n<span class=\"token comment\"># TypeScript</span>\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> eg2<span class=\"token punctuation\">.</span>tslint\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> johnpapa<span class=\"token punctuation\">.</span>Angular2\n\n<span class=\"token comment\"># Docker</span>\ncode <span class=\"token operator\">--</span><span class=\"token function\">install-extension</span> PeterJausovec<span class=\"token punctuation\">.</span>vscode<span class=\"token operator\">-</span>docker</code></pre></div>\n<p>The commands to install VS Code extensions from PowerShell are slightly different compared to what you would put directly into the VS Code command pallet. To know what value to pass into the <code class=\"language-text\">--install-extension</code> command, you can grab the fully qualified extension name from the Visual Studio Marketplace URL, like so:</p>\n<p><img src=\"/img/vs-code-extension-fully-qualified-name_600x357.png\" alt=\"Fully qualified VS code extension name example\"></p>\n<h2>Advanced Options</h2>\n<p>I recently configured a similar script for a large development team. Though the team uses a lot of required tools, they also have a lot options that boil down to personal preference. For example, some of the developers prefer IntelliJ while others prefer Eclipse.</p>\n<p>This can be easily handled by accepting arguments and choosing wise defaults. As an example, let's install both by default but allow the user to specify the IDE as a command-line argument. Start by using <code class=\"language-text\">params</code> at the top of the script:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">params<span class=\"token punctuation\">(</span>\n    <span class=\"token namespace\">[string[]]</span>\n    <span class=\"token variable\">$ide</span>=@<span class=\"token punctuation\">(</span><span class=\"token string\">\"intellij\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"eclipse\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Later on, we can read the argument:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\"><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ide</span> <span class=\"token operator\">-contains</span> <span class=\"token string\">\"intellij\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    choco install intellijidea<span class=\"token operator\">-</span>ultimate <span class=\"token operator\">--</span>yes\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$ide</span> <span class=\"token operator\">-contains</span> <span class=\"token string\">\"eclipse\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    choco install eclipse <span class=\"token operator\">--</span>yes\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Finally, the script can be called with the <code class=\"language-text\">-ide</code> argument. Here's an example to install only Eclipse:</p>\n<div class=\"gatsby-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">env<span class=\"token operator\">-</span>windows<span class=\"token punctuation\">.</span>ps1 <span class=\"token operator\">-</span>ide eclipse</code></pre></div>\n<h2>A Full Example</h2>\n<p>You can view <a href=\"https://github.com/jamestharpe/windows-development-environment/blob/master/env-windows.ps1\">the script</a> I use personally on <a href=\"https://github.com/jamestharpe/\">my GitHub page</a> (MIT License). Contributions welcome!</p>"}